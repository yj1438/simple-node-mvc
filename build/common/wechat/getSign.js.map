{"version":3,"sources":["common/wechat/getSign.js"],"names":[],"mappings":";;;;;;;;AAAA,IAAI,iBAAiB,SAAjB,cAAiB,GAAY;AAC7B,WAAO,KAAK,MAAL,GAAc,QAAd,CAAuB,EAAvB,EAA2B,MAA3B,CAAkC,CAAlC,EAAqC,EAArC,CAAP;AACH,CAFD;;AAIA,IAAI,kBAAkB,SAAlB,eAAkB,GAAY;AAC9B,WAAO,SAAS,IAAI,IAAJ,GAAW,OAAX,KAAuB,IAAhC,IAAwC,EAA/C;AACH,CAFD;;AAIA,IAAI,MAAM,SAAN,GAAM,CAAU,IAAV,EAAgB;AACtB,QAAI,OAAO,oBAAY,IAAZ,CAAX;AACA,WAAO,KAAK,IAAL,EAAP;AACA,QAAI,UAAU,EAAd;AACA,SAAK,OAAL,CAAa,UAAU,GAAV,EAAe;AACxB,gBAAQ,IAAI,WAAJ,EAAR,IAA6B,KAAK,GAAL,CAA7B;AACH,KAFD;;AAIA,QAAI,SAAS,EAAb;AACA,SAAK,IAAI,CAAT,IAAc,OAAd,EAAuB;AACnB,kBAAU,MAAM,CAAN,GAAU,GAAV,GAAgB,QAAQ,CAAR,CAA1B;AACH;AACD,aAAS,OAAO,MAAP,CAAc,CAAd,CAAT;AACA,WAAO,MAAP;AACH,CAdD;;AAgBA;;;;;;;;AAQA,IAAI,OAAO,SAAP,IAAO,CAAU,YAAV,EAAwB,GAAxB,EAA6B;AACpC,QAAI,MAAM;AACN,sBAAc,YADR;AAEN,kBAAU,gBAFJ;AAGN,mBAAW,iBAHL;AAIN,aAAK;AAJC,KAAV;AAMA,QAAI,SAAS,IAAI,GAAJ,CAAb;AACA,YAAQ,QAAQ,OAAR,CAAR;AACA,aAAS,IAAI,KAAJ,CAAU,MAAV,EAAkB,MAAlB,CAAT;AACA,QAAI,SAAJ,GAAgB,OAAO,OAAP,CAAe,OAAf,EAAwB,KAAxB,CAAhB;;AAEA,WAAO,GAAP;AACH,CAbD;;AAeA,OAAO,OAAP,GAAiB,IAAjB","file":"common/wechat/getSign.js","sourcesContent":["var createNonceStr = function () {\n    return Math.random().toString(36).substr(2, 15);\n};\n\nvar createTimestamp = function () {\n    return parseInt(new Date().getTime() / 1000) + '';\n};\n\nvar raw = function (args) {\n    var keys = Object.keys(args);\n    keys = keys.sort()\n    var newArgs = {};\n    keys.forEach(function (key) {\n        newArgs[key.toLowerCase()] = args[key];\n    });\n\n    var string = '';\n    for (var k in newArgs) {\n        string += '&' + k + '=' + newArgs[k];\n    }\n    string = string.substr(1);\n    return string;\n};\n\n/**\n* @synopsis 签名算法 \n*\n* @param jsapi_ticket 用于签名的 jsapi_ticket\n* @param url 用于签名的 url ，注意必须动态获取，不能 hardcode\n*\n* @returns\n*/\nvar sign = function (jsapi_ticket, url) {\n    var ret = {\n        jsapi_ticket: jsapi_ticket,\n        nonceStr: createNonceStr(),\n        timestamp: createTimestamp(),\n        url: url\n    };\n    var string = raw(ret);\n    jsSHA = require('jssha');\n    shaObj = new jsSHA(string, 'TEXT');\n    ret.signature = shaObj.getHash('SHA-1', 'HEX');\n\n    return ret;\n};\n\nmodule.exports = sign;\n"],"sourceRoot":"/source/"}