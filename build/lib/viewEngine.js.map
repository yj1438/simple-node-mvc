{"version":3,"sources":["lib/viewEngine.js"],"names":[],"mappings":"AAAA;;;AAGA;;;;;;;;AAEA,IAAM,OAAO,QAAQ,MAAR,CAAb;AAAA,IACI,WAAW,QAAQ,cAAR,CADf;AAAA,IAEI,YAAY,QAAQ,kBAAR,CAFhB;AAAA,IAGI,eAAe,QAAQ,gBAAR,CAHnB;;AAKA,IAAM,WAAW,QAAQ,GAAR,EAAjB;AAAA,IACI,YAAY,QAAQ,aAAR,CADhB;;AAGA,OAAO,OAAP,GAAiB;AACb,YAAQ,aAAa,GADR;;AAGb,YAAQ,gBAAU,QAAV,EAAoB,IAApB,EAA0B;AAC9B,YAAI,WAAW,KAAK,IAAL,CAAU,QAAV,EAAoB,cAApB,EAAoC,QAApC,CAAf;AAAA,YACI,eADJ;AAAA,YAEI,kBAFJ;AAGA,YAAI;AACA,qBAAS,SAAS,QAAT,EAAmB,IAAnB,CAAT;AACA,wBAAY,UAAU,MAAV,CAAZ;AACA,iBAAK,MAAL,CAAY,SAAZ,EAAuB,MAAvB,EAA+B,EAA/B;AACH,SAJD,CAIE,OAAO,GAAP,EAAY;AACV,sBAAU,UAAV,CAAqB,KAAK,GAA1B,EAA+B,KAAK,GAApC,EAAyC,IAAI,QAAJ,EAAzC;AACA;AACH;AACJ,KAfY;AAgBb,gBAAY,oBAAU,IAAV,EAAgB;AACxB,YAAM,iBAAiB,KAAK,MAAL,CAAY,QAAnC;AACA,YAAI,kBAAJ;AACA,YAAI,cAAJ,EAAoB;AAChB,wBAAY,UAAU,iBAAiB,GAAjB,GAAuB,yBAAe,IAAf,CAAvB,GAA8C,GAAxD,CAAZ;AACH,SAFD,MAEO;AACH,wBAAY,UAAU,yBAAe,IAAf,CAAV,CAAZ;AACH;AACD,aAAK,MAAL,CAAY,SAAZ,EAAuB,MAAvB,EAA+B,EAA/B;AAEH;AA1BY,CAAjB","file":"lib/viewEngine.js","sourcesContent":["/**\n* 模板引擎\n*/\n'use strict';\n\nconst path = require('path'),\n    template = require('art-template'),\n    str2steam = require('string-to-stream'),\n    responseUtil = require('./responseUtil');\n\nconst basePath = process.cwd(),\n    httpError = require('./httpError');\n\nmodule.exports = {\n    output: responseUtil.out,\n    \n    render: function (viewName, data) {\n        let viewfile = path.join(basePath, 'server/views', viewName),\n            output,\n            strStream;\n        try {\n            output = template(viewfile, data);\n            strStream = str2steam(output);\n            this.output(strStream, 'html', {});\n        } catch (err) {\n            httpError.handler500(this.req, this.res, err.toString());\n            return;\n        }\n    },\n    renderJson: function (data) {\n        const callbackFnName = this.params.callback;\n        let strStream;\n        if (callbackFnName) {\n            strStream = str2steam(callbackFnName + '(' + JSON.stringify(data) + ')');\n        } else {\n            strStream = str2steam(JSON.stringify(data));\n        }\n        this.output(strStream, 'json', {});\n        \n    }\n};"],"sourceRoot":"/source/"}