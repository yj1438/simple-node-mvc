{"version":3,"sources":["http2.js"],"names":[],"mappings":"AAAA;;AACA,IAAI,QAAQ,QAAQ,OAAR,CAAZ;AAAA,IACI,KAAK,QAAQ,IAAR,CADT;AAAA,IAEI,OAAO,QAAQ,MAAR,CAFX;AAGA,IAAI,SAAS,QAAQ,UAAR,CAAb;AAAA,IACI,SAAS,QAAQ,UAAR,CADb;;AAGA,IAAI,UAAU,OAAO,WAArB;;AAEA,IAAI,MAAM,MAAM,YAAN,CAAmB,OAAnB,EAA4B,UAAU,GAAV,EAAe,GAAf,EAAoB;AACtD,QAAI,YAAY,EAAhB;AACA;AACA,QAAI,EAAJ,CAAO,MAAP,EAAe,UAAU,KAAV,EAAiB;AAC5B,qBAAa,KAAb;AACH,KAFD,EAEG,EAFH,CAEM,KAFN,EAEa,YAAY;AACrB,YAAI,IAAJ,GAAW,SAAX;AACA;AACA,YAAI,IAAI,GAAJ,CAAQ,OAAR,CAAgB,YAAhB,IAAgC,CAAC,CAAjC,IAAsC,IAAI,IAA9C,EAAoD;AAChD,gBAAI,OAAO,IAAI,IAAJ,CAAS,qBAAT,CAAX;AACA,iBAAK,SAAL,CAAe,GAAf,EAAoB,EAAC,gBAAgB,iBAAjB,EAApB;AACA,eAAG,gBAAH,CAAoB,KAAK,IAAL,CAAU,SAAV,EAAqB,4BAArB,CAApB,EAAwE,IAAxE,CAA6E,IAA7E;AACH;AACD,eAAO,cAAP,CAAsB,GAAtB,EAA2B,GAA3B;AACH,KAXD;AAYH,CAfS,EAeP,MAfO,CAeA,OAAO,QAfP,EAeiB,OAAO,IAfxB,EAe8B,YAAY;AAChD,YAAQ,GAAR,CAAY,sCAAsC,OAAO,IAA7C,GAAoD,GAApD,GAA0D,OAAO,QAAjE,GAA4E,GAAxF;AACH,CAjBS,CAAV;;AAmBA;;;AAGA,IAAI,OAAO,QAAQ,MAAR,CAAX;AACA,KAAK,YAAL,CAAkB,UAAU,GAAV,EAAe,GAAf,EAAoB;AAClC,QAAI,SAAJ,CAAc,GAAd,EAAmB,EAAE,YAAY,aAAa,IAAI,OAAJ,CAAY,IAAzB,GAAgC,IAAI,GAAlD,EAAnB;AACA,QAAI,GAAJ;AACH,CAHD,EAGG,MAHH,CAGU,OAAO,WAHjB,EAG8B,OAAO,IAHrC","file":"http2.js","sourcesContent":["'use strict';\nvar http2 = require('http2'),\n    fs = require('fs'),\n    path = require('path');\nvar config = require('./config'),\n    server = require('./server');\n\nvar options = config.certificate;\n\nvar app = http2.createServer(options, function (req, res) {\n    var _postData = '';\n    //on用于添加一个监听函数到一个特定的事件\n    req.on('data', function (chunk) {\n        _postData += chunk;\n    }).on('end', function () {\n        req.post = _postData;\n        //server push 的例子，在频繁请求下会出错，还不清楚是什么情况\n        if (req.url.indexOf('http2/demo') > -1 && res.push) {\n            var push = res.push('/js/jquery-2.1.4.js');\n            push.writeHead(200, {'content-type': 'text/javascript'});\n            fs.createReadStream(path.join(__dirname, '/static/js/jquery-2.1.4.js')).pipe(push);\n        }\n        server.handlerRequest(req, res);\n    });\n}).listen(config.port_ssl, config.host, function () {\n    console.log('HTTP/2 Server running at https://' + config.host + ':' + config.port_ssl + '/');\n});\n\n/*\n * http 方式的 redirect\n */\nvar http = require('http');\nhttp.createServer(function (req, res) {\n    res.writeHead(301, { \"Location\": \"https://\" + req.headers.host + req.url });\n    res.end();\n}).listen(config.port_normal, config.host);\n"],"sourceRoot":"/source/"}